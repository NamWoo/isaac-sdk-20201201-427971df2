var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(c,d){return Object.prototype.hasOwnProperty.call(c,d)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(c,d){for(var b=1;b<arguments.length;b++){var e=arguments[b];if(e)for(var l in e)$jscomp.owns(e,l)&&(c[l]=e[l])}return c};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,d,b){c!=Array.prototype&&c!=Object.prototype&&(c[d]=b.value)};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,c];for(var d=0;d<c.length;++d){var b=c[d];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,d,b,e){if(d){b=$jscomp.global;c=c.split(".");for(e=0;e<c.length-1;e++){var l=c[e];l in b||(b[l]={});b=b[l]}c=c[c.length-1];e=b[c];d=d(e);d!=e&&null!=d&&$jscomp.defineProperty(b,c,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Object.assign",function(c){return c||$jscomp.assign},"es6","es3");
THREE.TransformControls=function(c,d){function b(a,b){var z=b;Object.defineProperty(m,a,{get:function(){return void 0!==z?z:b},set:function(b){z!==b&&(z=b,x[a]=b,A[a]=b,m.dispatchEvent({type:a+"-changed",value:b}),m.dispatchEvent(F))}});m[a]=b;x[a]=b;A[a]=b}function e(a){var b=a.changedTouches?a.changedTouches[0]:a,z=d.getBoundingClientRect();return{x:(b.clientX-z.left)/z.width*2-1,y:-(b.clientY-z.top)/z.height*2+1,button:a.button}}function l(a){a.preventDefault()}function h(a){m.enabled&&m.pointerHover(e(a))}
function u(a){m.enabled&&(a.preventDefault(),m.pointerHover(e(a)),m.pointerDown(e(a)))}function r(a){m.enabled&&(a.preventDefault(),m.pointerMove(e(a)))}function v(a){m.enabled&&m.pointerMove(e(a))}function y(a){m.enabled&&(a.preventDefault(),m.pointerUp(e(a)))}function K(a){m.enabled&&m.pointerUp(e(a))}THREE.Object3D.call(this);d=void 0!==d?d:document;this.visible=!1;var A=new THREE.TransformControlsGizmo;this.add(A);var x=new THREE.TransformControlsPlane;this.add(x);var m=this;b("camera",c);b("object",
void 0);b("enabled",!0);b("axis",null);b("mode","translate");b("translationSnap",null);b("rotationSnap",null);b("space","world");b("size",1);b("dragging",!1);b("showX",!0);b("showY",!0);b("showZ",!0);var F={type:"change"},G={type:"mouseDown"},B={type:"mouseUp",mode:m.mode},L={type:"objectChange"},t=new THREE.Raycaster,n=new THREE.Vector3,k=new THREE.Vector3,w=new THREE.Quaternion,T={X:new THREE.Vector3(1,0,0),Y:new THREE.Vector3(0,1,0),Z:new THREE.Vector3(0,0,1)},O=new THREE.Quaternion,M=new THREE.Vector3,
f=new THREE.Vector3,q=new THREE.Vector3,C=new THREE.Vector3,g=0,D=new THREE.Vector3,Q=new THREE.Quaternion,J=new THREE.Vector3,E=new THREE.Vector3,H=new THREE.Quaternion,p=new THREE.Vector3,R=new THREE.Vector3,P=new THREE.Quaternion,a=new THREE.Vector3,S=new THREE.Vector3,U=new THREE.Quaternion,X=new THREE.Vector3,I=new THREE.Vector3,V=new THREE.Vector3,N=new THREE.Quaternion,W=new THREE.Vector3;b("parentQuaternion",H);b("worldPosition",S);b("worldPositionStart",R);b("worldQuaternion",U);b("worldQuaternionStart",
P);b("cameraPosition",D);b("cameraQuaternion",Q);b("pointStart",f);b("pointEnd",q);b("rotationAxis",C);b("rotationAngle",g);b("eye",I);d.addEventListener("mousedown",u,!1);d.addEventListener("touchstart",u,!1);d.addEventListener("mousemove",h,!1);d.addEventListener("touchmove",h,!1);document.addEventListener("mousemove",v,!1);d.addEventListener("touchmove",r,!1);document.addEventListener("mouseup",K,!1);d.addEventListener("touchend",y,!1);d.addEventListener("touchcancel",y,!1);d.addEventListener("touchleave",
y,!1);d.addEventListener("contextmenu",l,!1);this.dispose=function(){d.removeEventListener("mousedown",u);d.removeEventListener("touchstart",u);d.removeEventListener("mousemove",h);d.removeEventListener("touchmove",h);document.removeEventListener("mousemove",v);d.removeEventListener("touchmove",r);document.removeEventListener("mouseup",K);d.removeEventListener("touchend",y);d.removeEventListener("touchcancel",y);d.removeEventListener("touchleave",y);d.removeEventListener("contextmenu",l)};this.attach=
function(a){this.object=a;this.visible=!0};this.detach=function(){this.object=void 0;this.visible=!1;this.axis=null};this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),this.object.parent.matrixWorld.decompose(E,H,p),this.object.matrixWorld.decompose(S,U,X));this.camera.updateMatrixWorld();this.camera.matrixWorld.decompose(D,Q,J);this.camera instanceof THREE.PerspectiveCamera?I.copy(D).sub(S).normalize():this.camera instanceof THREE.OrthographicCamera&&I.copy(D).normalize();
THREE.Object3D.prototype.updateMatrixWorld.call(this)};this.pointerHover=function(a){void 0===this.object||!0===this.dragging||void 0!==a.button&&0!==a.button||(t.setFromCamera(a,this.camera),this.axis=(a=t.intersectObjects(A.picker[this.mode].children,!0)[0]||!1)?a.object.name:null)};this.pointerDown=function(b){if(!(void 0===this.object||!0===this.dragging||void 0!==b.button&&0!==b.button||0!==b.button&&void 0!==b.button||null===this.axis)){t.setFromCamera(b,this.camera);if(b=t.intersectObjects([x],
!0)[0]||!1){var d=this.space;if("scale"===this.mode)d="local";else if("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)d="world";if("local"===d&&"rotate"===this.mode){var c=this.rotationSnap;"X"===this.axis&&c&&(this.object.rotation.x=Math.round(this.object.rotation.x/c)*c);"Y"===this.axis&&c&&(this.object.rotation.y=Math.round(this.object.rotation.y/c)*c);"Z"===this.axis&&c&&(this.object.rotation.z=Math.round(this.object.rotation.z/c)*c)}this.object.updateMatrixWorld();this.object.parent.updateMatrixWorld();
V.copy(this.object.position);N.copy(this.object.quaternion);W.copy(this.object.scale);this.object.matrixWorld.decompose(R,P,a);f.copy(b.point).sub(R);"local"===d&&f.applyQuaternion(P.clone().inverse())}this.dragging=!0;G.mode=this.mode;this.dispatchEvent(G)}};this.pointerMove=function(a){var b=this.axis,d=this.mode,c=this.object,p=this.space;if("scale"===d)p="local";else if("E"===b||"XYZE"===b||"XYZ"===b)p="world";if(void 0!==c&&null!==b&&!1!==this.dragging&&(void 0===a.button||0===a.button)&&(t.setFromCamera(a,
this.camera),a=t.intersectObjects([x],!0)[0]||!1,!1!==a)){q.copy(a.point).sub(R);"local"===p&&q.applyQuaternion(P.clone().inverse());if("translate"===d)-1===b.search("X")&&(q.x=f.x),-1===b.search("Y")&&(q.y=f.y),-1===b.search("Z")&&(q.z=f.z),"local"===p?c.position.copy(q).sub(f).applyQuaternion(N):c.position.copy(q).sub(f),c.position.add(V),this.translationSnap&&("local"===p&&(c.position.applyQuaternion(w.copy(N).inverse()),-1!==b.search("X")&&(c.position.x=Math.round(c.position.x/this.translationSnap)*
this.translationSnap),-1!==b.search("Y")&&(c.position.y=Math.round(c.position.y/this.translationSnap)*this.translationSnap),-1!==b.search("Z")&&(c.position.z=Math.round(c.position.z/this.translationSnap)*this.translationSnap),c.position.applyQuaternion(N)),"world"===p&&(c.parent&&c.position.add(n.setFromMatrixPosition(c.parent.matrixWorld)),-1!==b.search("X")&&(c.position.x=Math.round(c.position.x/this.translationSnap)*this.translationSnap),-1!==b.search("Y")&&(c.position.y=Math.round(c.position.y/
this.translationSnap)*this.translationSnap),-1!==b.search("Z")&&(c.position.z=Math.round(c.position.z/this.translationSnap)*this.translationSnap),c.parent&&c.position.sub(n.setFromMatrixPosition(c.parent.matrixWorld))));else if("scale"===d)-1!==b.search("XYZ")?(b=q.length()/f.length(),0>q.dot(f)&&(b*=-1),n.set(b,b,b)):(n.copy(q).divide(f),-1===b.search("X")&&(n.x=1),-1===b.search("Y")&&(n.y=1),-1===b.search("Z")&&(n.z=1)),c.scale.copy(W).multiply(n);else if("rotate"===d){d=20/S.distanceTo(n.setFromMatrixPosition(this.camera.matrixWorld));
a="local"===this.space?U:O;var e=T[b];if("E"===b)n.copy(q).cross(f),C.copy(I),g=q.angleTo(f)*(0>n.dot(I)?1:-1);else if("XYZE"===b)n.copy(q).sub(f).cross(I).normalize(),C.copy(n),g=q.sub(f).dot(n.cross(I))*d;else if("X"===b||"Y"===b||"Z"===b)M.copy(e).applyQuaternion(a),C.copy(e),n=e.clone(),k=q.clone().sub(f),"local"===p&&(n.applyQuaternion(a),k.applyQuaternion(P)),g=k.dot(n.cross(I).normalize())*d;this.rotationSnap&&(g=Math.round(g/this.rotationSnap)*this.rotationSnap);this.rotationAngle=g;"local"===
p?(c.quaternion.copy(N),c.quaternion.multiply(w.setFromAxisAngle(C,g))):(c.quaternion.copy(w.setFromAxisAngle(C,g)),c.quaternion.multiply(N))}this.dispatchEvent(F);this.dispatchEvent(L)}};this.pointerUp=function(a){if(void 0===a.button||0===a.button)this.dragging&&null!==this.axis&&(B.mode=this.mode,this.dispatchEvent(B)),this.dragging=!1,void 0===a.button&&(this.axis=null)};this.getMode=function(){return m.mode};this.setMode=function(a){m.mode=a};this.setTranslationSnap=function(a){m.translationSnap=
a};this.setRotationSnap=function(a){m.rotationSnap=a};this.setSize=function(a){m.size=a};this.setSpace=function(a){m.space=a};this.update=function(){console.warn("THREE.TransformControls: update function has been depricated.")}};THREE.TransformControls.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.TransformControls,isTransformControls:!0});
THREE.TransformControlsGizmo=function(){THREE.Object3D.call(this);this.type="TransformControlsGizmo";var c=new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:THREE.DoubleSide,fog:!1}),d=new THREE.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),b=c.clone();b.opacity=.15;var e=c.clone();e.opacity=.33;var l=c.clone();l.color.set(16711680);var h=c.clone();h.color.set(65280);var u=c.clone();u.color.set(255);var r=c.clone();r.opacity=.25;var v=
r.clone();v.color.set(16776960);var y=r.clone();y.color.set(65535);var K=r.clone();K.color.set(16711935);c.clone().color.set(16776960);var A=d.clone();A.color.set(16711680);var x=d.clone();x.color.set(65280);var m=d.clone();m.color.set(255);var F=d.clone();F.color.set(65535);var G=d.clone();G.color.set(16711935);var B=d.clone();B.color.set(16776960);var L=d.clone();L.color.set(7895160);var t=B.clone();t.opacity=.25;d=new THREE.CylinderBufferGeometry(0,.05,.2,12,1,!1);var n=new THREE.BoxBufferGeometry(.125,
.125,.125),k=new THREE.BufferGeometry;k.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,1,0,0],3));var w=function(b,c){for(var d=new THREE.BufferGeometry,a=[],p=0;p<=64*c;++p)a.push(0,Math.cos(p/32*Math.PI)*b,Math.sin(p/32*Math.PI)*b);d.addAttribute("position",new THREE.Float32BufferAttribute(a,3));return d};d={X:[[new THREE.Mesh(d,l),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new THREE.Mesh(d,l),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new THREE.Line(k,A)]],Y:[[new THREE.Mesh(d,h),[0,1,0],
null,null,"fwd"],[new THREE.Mesh(d,h),[0,1,0],[Math.PI,0,0],null,"bwd"],[new THREE.Line(k,x),null,[0,0,Math.PI/2]]],Z:[[new THREE.Mesh(d,u),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new THREE.Mesh(d,u),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new THREE.Line(k,m),null,[0,-Math.PI/2,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronBufferGeometry(.1,0),r),[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.295,.295),v),[.15,.15,0]],[new THREE.Line(k,B),[.18,.3,0],null,[.125,1,1]],[new THREE.Line(k,
B),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.295,.295),y),[0,.15,.15],[0,Math.PI/2,0]],[new THREE.Line(k,F),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new THREE.Line(k,F),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.295,.295),K),[.15,0,.15],[-Math.PI/2,0,0]],[new THREE.Line(k,G),[.18,0,.3],null,[.125,1,1]],[new THREE.Line(k,G),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]};c={X:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,
0,1,4,1,!1),b),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),b),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,!1),b),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronBufferGeometry(.2,0),b)]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),b),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),b),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,
.4),b),[.2,0,.2],[-Math.PI/2,0,0]]]};var T={START:[[new THREE.Mesh(new THREE.OctahedronBufferGeometry(.01,2),e),null,null,null,"helper"]],END:[[new THREE.Mesh(new THREE.OctahedronBufferGeometry(.01,2),e),null,null,null,"helper"]],DELTA:[[new THREE.Line(function(b,c){b=new THREE.BufferGeometry;b.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,1,1,1],3));return b}(),e),null,null,null,"helper"]],X:[[new THREE.Line(k,e.clone()),[-1E3,0,0],null,[1E6,1,1],"helper"]],Y:[[new THREE.Line(k,
e.clone()),[0,-1E3,0],[0,0,Math.PI/2],[1E6,1,1],"helper"]],Z:[[new THREE.Line(k,e.clone()),[0,0,-1E3],[0,-Math.PI/2,0],[1E6,1,1],"helper"]]};L={X:[[new THREE.Line(w(1,.5),A)],[new THREE.Mesh(new THREE.OctahedronBufferGeometry(.04,0),l),[0,0,.99],null,[1,3,1]]],Y:[[new THREE.Line(w(1,.5),x),null,[0,0,-Math.PI/2]],[new THREE.Mesh(new THREE.OctahedronBufferGeometry(.04,0),h),[0,0,.99],null,[3,1,1]]],Z:[[new THREE.Line(w(1,.5),m),null,[0,Math.PI/2,0]],[new THREE.Mesh(new THREE.OctahedronBufferGeometry(.04,
0),u),[.99,0,0],null,[1,3,1]]],E:[[new THREE.Line(w(1.25,1),t),null,[0,Math.PI/2,0]],[new THREE.Mesh(new THREE.CylinderBufferGeometry(.03,0,.15,4,1,!1),t),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new THREE.Mesh(new THREE.CylinderBufferGeometry(.03,0,.15,4,1,!1),t),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new THREE.Mesh(new THREE.CylinderBufferGeometry(.03,0,.15,4,1,!1),t),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new THREE.Mesh(new THREE.CylinderBufferGeometry(.03,0,.15,4,1,!1),t),[0,1.17,0],[0,0,0],
[1,1,.001]]],XYZE:[[new THREE.Line(w(1,1),L),null,[0,Math.PI/2,0]]]};t={AXIS:[[new THREE.Line(k,e.clone()),[-1E3,0,0],null,[1E6,1,1],"helper"]]};w={X:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.1,4,24),b),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.1,4,24),b),[0,0,0],[Math.PI/2,0,0]]],Z:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.1,4,24),b),[0,0,0],[0,0,-Math.PI/2]]],E:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1.25,.1,2,24),b)]],XYZE:[[new THREE.Mesh(new THREE.SphereBufferGeometry(.7,
10,8),b)]]};l={X:[[new THREE.Mesh(n,l),[.8,0,0],[0,0,-Math.PI/2]],[new THREE.Line(k,A),null,null,[.8,1,1]]],Y:[[new THREE.Mesh(n,h),[0,.8,0]],[new THREE.Line(k,x),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new THREE.Mesh(n,u),[0,0,.8],[Math.PI/2,0,0]],[new THREE.Line(k,m),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new THREE.Mesh(n,v),[.85,.85,0],null,[2,2,.2]],[new THREE.Line(k,B),[.855,.98,0],null,[.125,1,1]],[new THREE.Line(k,B),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new THREE.Mesh(n,y),[0,.85,.85],
null,[.2,2,2]],[new THREE.Line(k,F),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new THREE.Line(k,F),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new THREE.Mesh(n,K),[.85,0,.85],null,[2,.2,2]],[new THREE.Line(k,G),[.855,0,.98],null,[.125,1,1]],[new THREE.Line(k,G),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.125,.125,.125),r),[1.1,0,0]]],XYZY:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.125,.125,.125),r),[0,1.1,0]]],XYZZ:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.125,
.125,.125),r),[0,0,1.1]]]};b={X:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,.8,4,1,!1),b),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,.8,4,1,!1),b),[0,.5,0]]],Z:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,.8,4,1,!1),b),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new THREE.Mesh(n,b),[.85,.85,0],null,[3,3,.2]]],YZ:[[new THREE.Mesh(n,b),[0,.85,.85],null,[.2,3,3]]],XZ:[[new THREE.Mesh(n,b),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.2,
.2,.2),b),[1.1,0,0]]],XYZY:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.2,.2,.2),b),[0,1.1,0]]],XYZZ:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.2,.2,.2),b),[0,0,1.1]]]};e={X:[[new THREE.Line(k,e.clone()),[-1E3,0,0],null,[1E6,1,1],"helper"]],Y:[[new THREE.Line(k,e.clone()),[0,-1E3,0],[0,0,Math.PI/2],[1E6,1,1],"helper"]],Z:[[new THREE.Line(k,e.clone()),[0,0,-1E3],[0,-Math.PI/2,0],[1E6,1,1],"helper"]]};h=function(b){var c=new THREE.Object3D,d;for(d in b)for(var a=b[d].length;a--;){var e=b[d][a][0].clone(),
f=b[d][a][1],p=b[d][a][2],g=b[d][a][3],h=b[d][a][4];e.name=d;e.tag=h;f&&e.position.set(f[0],f[1],f[2]);p&&e.rotation.set(p[0],p[1],p[2]);g&&e.scale.set(g[0],g[1],g[2]);e.updateMatrix();f=e.geometry.clone();f.applyMatrix(e.matrix);e.geometry=f;e.position.set(0,0,0);e.rotation.set(0,0,0);e.scale.set(1,1,1);c.add(e)}return c};var O=new THREE.Vector3(0,0,0),M=new THREE.Euler,f=new THREE.Vector3(0,1,0),q=new THREE.Vector3(0,0,0),C=new THREE.Matrix4,g=new THREE.Quaternion,D=new THREE.Quaternion,Q=new THREE.Quaternion,
J=new THREE.Vector3(1,0,0),E=new THREE.Vector3(0,1,0),H=new THREE.Vector3(0,0,1);this.gizmo={};this.picker={};this.helper={};this.add(this.gizmo.translate=h(d));this.add(this.gizmo.rotate=h(L));this.add(this.gizmo.scale=h(l));this.add(this.picker.translate=h(c));this.add(this.picker.rotate=h(w));this.add(this.picker.scale=h(b));this.add(this.helper.translate=h(T));this.add(this.helper.rotate=h(t));this.add(this.helper.scale=h(e));this.picker.translate.visible=!1;this.picker.rotate.visible=!1;this.picker.scale.visible=
!1;this.updateMatrixWorld=function(){var b=this.space;"scale"===this.mode&&(b="local");b="local"===b?this.worldQuaternion:Q;this.gizmo.translate.visible="translate"===this.mode;this.gizmo.rotate.visible="rotate"===this.mode;this.gizmo.scale.visible="scale"===this.mode;this.helper.translate.visible="translate"===this.mode;this.helper.rotate.visible="rotate"===this.mode;this.helper.scale.visible="scale"===this.mode;var c=[];c=c.concat(this.picker[this.mode].children);c=c.concat(this.gizmo[this.mode].children);
c=c.concat(this.helper[this.mode].children);for(var d=0;d<c.length;d++){var a=c[d];a.visible=!0;a.rotation.set(0,0,0);a.position.copy(this.worldPosition);var e=this.worldPosition.distanceTo(this.cameraPosition);a.scale.set(1,1,1).multiplyScalar(e*this.size/7);"helper"===a.tag?(a.visible=!1,"AXIS"===a.name?(a.position.copy(this.worldPositionStart),a.visible=!!this.axis,"X"===this.axis&&(g.setFromEuler(M.set(0,0,0)),a.quaternion.copy(b).multiply(g),.9<Math.abs(f.copy(J).applyQuaternion(b).dot(this.eye))&&
(a.visible=!1)),"Y"===this.axis&&(g.setFromEuler(M.set(0,0,Math.PI/2)),a.quaternion.copy(b).multiply(g),.9<Math.abs(f.copy(E).applyQuaternion(b).dot(this.eye))&&(a.visible=!1)),"Z"===this.axis&&(g.setFromEuler(M.set(0,Math.PI/2,0)),a.quaternion.copy(b).multiply(g),.9<Math.abs(f.copy(H).applyQuaternion(b).dot(this.eye))&&(a.visible=!1)),"XYZE"===this.axis&&(g.setFromEuler(M.set(0,Math.PI/2,0)),f.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(C.lookAt(q,f,E)),a.quaternion.multiply(g),a.visible=
this.dragging),"E"===this.axis&&(a.visible=!1)):"START"===a.name?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):"END"===a.name?(a.position.copy(this.worldPosition),a.visible=this.dragging):"DELTA"===a.name?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),O.set(1E-10,1E-10,1E-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),O.applyQuaternion(this.worldQuaternionStart.clone().inverse()),a.scale.copy(O),a.visible=this.dragging):
(a.quaternion.copy(b),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=-1!==this.axis.search(a.name)))):(a.quaternion.copy(b),"translate"===this.mode||"scale"===this.mode?(("X"===a.name||"XYZX"===a.name)&&.99<Math.abs(f.copy(J).applyQuaternion(b).dot(this.eye))&&(a.scale.set(1E-10,1E-10,1E-10),a.visible=!1),("Y"===a.name||"XYZY"===a.name)&&.99<Math.abs(f.copy(E).applyQuaternion(b).dot(this.eye))&&(a.scale.set(1E-10,1E-10,1E-10),a.visible=
!1),("Z"===a.name||"XYZZ"===a.name)&&.99<Math.abs(f.copy(H).applyQuaternion(b).dot(this.eye))&&(a.scale.set(1E-10,1E-10,1E-10),a.visible=!1),"XY"===a.name&&.2>Math.abs(f.copy(H).applyQuaternion(b).dot(this.eye))&&(a.scale.set(1E-10,1E-10,1E-10),a.visible=!1),"YZ"===a.name&&.2>Math.abs(f.copy(J).applyQuaternion(b).dot(this.eye))&&(a.scale.set(1E-10,1E-10,1E-10),a.visible=!1),"XZ"===a.name&&.2>Math.abs(f.copy(E).applyQuaternion(b).dot(this.eye))&&(a.scale.set(1E-10,1E-10,1E-10),a.visible=!1),-1!==a.name.search("X")&&
(-.4>f.copy(J).applyQuaternion(b).dot(this.eye)?"fwd"===a.tag?a.visible=!1:a.scale.x*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Y")&&(-.4>f.copy(E).applyQuaternion(b).dot(this.eye)?"fwd"===a.tag?a.visible=!1:a.scale.y*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Z")&&(-.4>f.copy(H).applyQuaternion(b).dot(this.eye)?"fwd"===a.tag?a.visible=!1:a.scale.z*=-1:"bwd"===a.tag&&(a.visible=!1))):"rotate"===this.mode&&(D.copy(b),f.copy(this.eye).applyQuaternion(g.copy(b).inverse()),-1!==
a.name.search("E")&&a.quaternion.setFromRotationMatrix(C.lookAt(this.eye,q,E)),"X"===a.name&&(g.setFromAxisAngle(J,Math.atan2(-f.y,f.z)),g.multiplyQuaternions(D,g),a.quaternion.copy(g)),"Y"===a.name&&(g.setFromAxisAngle(E,Math.atan2(f.x,f.z)),g.multiplyQuaternions(D,g),a.quaternion.copy(g)),"Z"===a.name&&(g.setFromAxisAngle(H,Math.atan2(f.y,f.x)),g.multiplyQuaternions(D,g),a.quaternion.copy(g))),a.visible=a.visible&&(-1===a.name.indexOf("X")||this.showX),a.visible=a.visible&&(-1===a.name.indexOf("Y")||
this.showY),a.visible=a.visible&&(-1===a.name.indexOf("Z")||this.showZ),a.visible=a.visible&&(-1===a.name.indexOf("E")||this.showX&&this.showY&&this.showZ),a.material._opacity=a.material._opacity||a.material.opacity,a.material._color=a.material._color||a.material.color.clone(),a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled)?this.axis&&(a.name===this.axis?a.material.opacity=1:this.axis.split("").some(function(b){return a.name===b})?a.material.opacity=1:
a.material.opacity*=.25,a.material.color.lerp(new THREE.Color(1,1,1),.5)):(a.material.opacity*=.5,a.material.color.lerp(new THREE.Color(1,1,1),.5))}THREE.Object3D.prototype.updateMatrixWorld.call(this)}};THREE.TransformControlsGizmo.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.TransformControlsGizmo,isTransformControlsGizmo:!0});
THREE.TransformControlsPlane=function(){THREE.Mesh.call(this,new THREE.PlaneBufferGeometry(1E5,1E5,2,2),new THREE.MeshBasicMaterial({visible:!1,wireframe:!0,side:THREE.DoubleSide,transparent:!0,opacity:.1}));this.type="TransformControlsPlane";var c=new THREE.Vector3(1,0,0),d=new THREE.Vector3(0,1,0),b=new THREE.Vector3(0,0,1),e=new THREE.Vector3,l=new THREE.Vector3,h=new THREE.Vector3,u=new THREE.Matrix4,r=new THREE.Quaternion;this.updateMatrixWorld=function(){var v=this.space;this.position.copy(this.worldPosition);
"scale"===this.mode&&(v="local");c.set(1,0,0).applyQuaternion("local"===v?this.worldQuaternion:r);d.set(0,1,0).applyQuaternion("local"===v?this.worldQuaternion:r);b.set(0,0,1).applyQuaternion("local"===v?this.worldQuaternion:r);h.copy(d);switch(this.mode){case "translate":case "scale":switch(this.axis){case "X":h.copy(this.eye).cross(c);l.copy(c).cross(h);break;case "Y":h.copy(this.eye).cross(d);l.copy(d).cross(h);break;case "Z":h.copy(this.eye).cross(b);l.copy(b).cross(h);break;case "XY":l.copy(b);
break;case "YZ":l.copy(c);break;case "XZ":h.copy(b);l.copy(d);break;case "XYZ":case "E":l.set(0,0,0)}break;default:l.set(0,0,0)}0===l.length()?this.quaternion.copy(this.cameraQuaternion):(u.lookAt(e.set(0,0,0),l,h),this.quaternion.setFromRotationMatrix(u));THREE.Object3D.prototype.updateMatrixWorld.call(this)}};THREE.TransformControlsPlane.prototype=Object.assign(Object.create(THREE.Mesh.prototype),{constructor:THREE.TransformControlsPlane,isTransformControlsPlane:!0});
